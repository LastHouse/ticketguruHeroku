(this.webpackJsonpticketguruHeroku=this.webpackJsonpticketguruHeroku||[]).push([[0],{123:function(e,t,a){e.exports=a(152)},128:function(e,t,a){},129:function(e,t,a){},150:function(e,t,a){},152:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),l=a.n(c),o=(a(128),a(129),a(14)),i=a(13),u=Object(n.createContext)(),s={isAuthenticated:!1,name:null,token:null};var m=function(e,t){switch(t.type){case"LOGIN_SUCCESS":return localStorage.setItem("name",JSON.stringify(t.payload.name)),localStorage.setItem("token",JSON.stringify(t.payload.token)),Object(i.a)({},e,{isAuthenticated:!0,name:t.payload.name,token:t.payload.token});case"LOGIN_FAIL":case"LOGOUT":return localStorage.clear(),Object(i.a)({},e,{isAuthenticated:!1,name:null});default:return e}};function E(e){var t=Object(n.useReducer)(m,s),a=Object(o.a)(t,2),c={auth:a[0],dispatch:a[1]};return r.a.createElement(u.Provider,Object.assign({value:c},e))}function d(){return Object(n.useContext)(u)}var p=a(15),h=a(19),f=a(205),g=a(206),b=a(207),k=a(53),v=a(197),C=a(91),S=a.n(C),y=a(209),T=a(228),O=a(199),j=a(201),N=a(202),w=a(203),x=a(204),_=a(89),F=a.n(_),A=a(90),H=a.n(A),I=a(75),R=a.n(I),U=Object(v.a)((function(e){return{root:{flexGrow:1},menuButton:{paddingTop:e.spacing(2),marginRight:e.spacing(2)},toolbar:{alignItems:"flex-start",paddingTop:e.spacing(1),paddingBottom:e.spacing(1),backgroundColor:"#d3d3d3",color:"black"},title:Object(h.a)({paddingTop:e.spacing(1),paddingBottom:e.spacing(1),alignItems:"flex-start",flexGrow:1,display:"none"},e.breakpoints.up("sm"),{display:"block"}),list:{width:250},fab:{margin:e.spacing(1)}}})),L=function(){var e,t=d(),a=t.auth,c=t.dispatch,l=U(),u=Object(n.useState)("home"),s=Object(o.a)(u,2),m=(s[0],s[1]),E=r.a.useState({top:!1,left:!1,bottom:!1,right:!1}),v=Object(o.a)(E,2),C=v[0],_=v[1],A=function(e,t){return function(a){("keydown"!==a.type||"Tab"!==a.key&&"Shift"!==a.key)&&_(Object(i.a)({},C,Object(h.a)({},e,t)))}},I=function(e){return function(){m(e)}};return r.a.createElement("div",{className:l.root},r.a.createElement(f.a,{position:"static"},r.a.createElement(g.a,null,a.isAuthenticated?r.a.createElement(b.a,{edge:"start",className:l.menuButton,color:"inherit","aria-label":"open drawer",onClick:A("left",!0)},r.a.createElement(S.a,null)):null,r.a.createElement(T.a,{open:C.left,onClose:A("left",!1)},(e="left",r.a.createElement("div",{className:l.list,role:"presentation",onClick:A(e,!1),onKeyDown:A(e,!1)},r.a.createElement(O.a,null,r.a.createElement(j.a,null),r.a.createElement(N.a,{button:!0,component:p.b,to:"/app/home",onClick:I("home")},r.a.createElement(w.a,null,r.a.createElement(F.a,null)),r.a.createElement(x.a,null,"Home")),r.a.createElement(N.a,{button:!0,component:p.b,to:"/app/tickets",onClick:I("tickets")},r.a.createElement(w.a,null,r.a.createElement(H.a,null)),r.a.createElement(x.a,null,"Tickets")),r.a.createElement(N.a,{button:!0,component:p.b,to:"/app/events",onClick:I("events")},r.a.createElement(w.a,null,r.a.createElement(R.a,null)),r.a.createElement(x.a,null,"Events")),r.a.createElement(N.a,{button:!0,component:p.b,to:"/app/ticketreader",onClick:I("Ticket Reader")},r.a.createElement(w.a,null,r.a.createElement(R.a,null)),r.a.createElement(x.a,null,"Ticket Reader"))),r.a.createElement(j.a,null)))),r.a.createElement(k.a,{variant:"h6",className:l.title},"TicketGuru"),r.a.createElement("div",null," ",a.isAuthenticated?r.a.createElement(y.a,{variant:"contained",color:"secondary",onClick:function(){return c({type:"LOGOUT"})}},"Logout"):null))))},B=a(37),G=Object(v.a)((function(e){return{root:{flexGrow:1,padding:e.spacing(3),textAlign:"center",alignContent:"strech"}}}));function D(){var e=G();return r.a.createElement("div",{className:e.root},r.a.createElement(k.a,{variant:"h1",component:"h2",gutterBottom:!0},"Tervetuloa!"),r.a.createElement(k.a,{variant:"h5",gutterBottom:!0},"T\xe4m\xe4 on aivan k\xe4sitt\xe4m\xe4tt\xf6m\xe4n upea TicketGuru UI."),r.a.createElement(j.a,null),r.a.createElement(k.a,{variant:"body1",gutterBottom:!0},r.a.createElement("br",null),"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quos blanditiis tenetur unde suscipit, quam beatae rerum inventore consectetur, neque doloribus, cupiditate numquam dignissimos laborum fugiat deleniti? Eum quasi quidem quibusdam."))}var M=a(92),q=a.n(M),K=(a(136),a(210)),Y=a(212),P=a(216),Q=a(215),z=a(211),V=a(213),W=a(214),J=Object(v.a)((function(e){return{root:{flexGrow:1,textAlign:"center"},text:{paddingRight:e.spacing(4),paddingLeft:e.spacing(4),paddingBottom:e.spacing(2),elevation:0,spacing:4,alignContent:"stretch",textAlign:"center",color:e.palette.text.secondary},table:{minWidth:650,textAlign:"center",color:e.palette.text.secondary}}})),$={events:[],isFetching:!1,hasError:!1},X=function(e,t){switch(t.type){case"FETCH_EVENTS_REQUEST":return Object(i.a)({},e,{isFetching:!0,hasError:!1});case"FETCH_EVENTS_SUCCESS":return Object(i.a)({},e,{isFetching:!1,events:t.payload});case"FETCH_EVENTS_FAILURE":return Object(i.a)({},e,{hasError:!0,isFetching:!1});default:return e}},Z=function(){var e=r.a.useReducer(X,$),t=Object(o.a)(e,2),a=t[0],n=t[1],c=J(),l=d().auth;return r.a.useEffect((function(){n({type:"FETCH_EVENTS_REQUEST"}),fetch("https://rbmk-ticketguru-backend.herokuapp.com/api/events",{headers:{Authorization:"Bearer ".concat(l.token)}}).then((function(e){if(e.ok)return e.json();throw e})).then((function(e){n({type:"FETCH_EVENTS_SUCCESS",payload:e._embedded.events})})).catch((function(e){console.log(e),n({type:"FETCH_EVENTS_FAILURE"})}))}),[l.token]),r.a.createElement("div",{className:"events"},r.a.createElement(K.a,{container:!0,direction:"row",justify:"flex-start",alignItems:"flex-start"},r.a.createElement("div",{className:c.text},r.a.createElement("h2",null,"Events")),r.a.createElement(j.a,null),a.isFetching?r.a.createElement("div",{className:"loader"},"LOADING..."):a.hasError?r.a.createElement("div",{className:"error"},"AN ERROR HAS OCCURED"):r.a.createElement(r.a.Fragment,null,r.a.createElement(z.a,null,r.a.createElement(Y.a,{className:c.table},r.a.createElement(V.a,null,r.a.createElement(W.a,null,r.a.createElement(Q.a,{align:"center"},"Name"),r.a.createElement(Q.a,{align:"center"},"Date"),r.a.createElement(Q.a,{align:"center"},"Ticket Capacity"),r.a.createElement(Q.a,{align:"center"},"Info"))),r.a.createElement(P.a,null,a.events.map((function(e){return r.a.createElement(W.a,{key:e.name},r.a.createElement(Q.a,{align:"center",component:"th",scope:"row"},e.name),r.a.createElement(Q.a,{align:"center"},r.a.createElement(q.a,{format:"DD/MM/YYYY  HH:mm"},e.dateTime)),r.a.createElement(Q.a,{align:"center"},e.ticketCapacity),r.a.createElement(Q.a,{align:"center"},e.info))}))))))))},ee=a(101),te=a(100),ae=(a(139),a(55)),ne=a.n(ae),re=a(218),ce=a(221),le=a(220),oe=a(219),ie=a(95),ue=a.n(ie),se=a(231),me=a(93);function Ee(e){var t=d().auth,a=Object(n.useState)(!1),c=Object(o.a)(a,2),l=c[0],i=c[1],u=Object(n.useState)({checkSum:"",ticketStatus:""}),s=Object(o.a)(u,2),m=s[0],E=s[1],p=function(){i(!1)};return r.a.createElement("div",null,r.a.createElement(se.a,{title:"Read"},r.a.createElement(b.a,{onClick:function(){return E({checkSum:e.ticket.checkSum}),void i(!0)}},r.a.createElement(ue.a,null))),r.a.createElement(re.a,{open:l,onClose:p,"aria-labelledby":"form-dialog-title"},r.a.createElement(oe.a,{id:"form-dialog-title"},"Read Ticket"),r.a.createElement(le.a,null,r.a.createElement(me.QRCode,{bgColor:"#FFFFFF",fgColor:"#000000",level:"Q",style:{width:256},value:m.checkSum})),r.a.createElement(le.a,null,r.a.createElement(y.a,{variant:"contained",color:"secondary",onClick:function(){fetch(e.ticket._links.self.href,{method:"PATCH",headers:{Authorization:"Bearer ".concat(t.token),"Content-Type":"application/json"},body:JSON.stringify({ticketStatus:"http://localhost:8080/api/ticketStatuses/2"})}).catch((function(e){return console.error(e)}))}},"Mark as Used")),r.a.createElement(ce.a,null,r.a.createElement(y.a,{onClick:p,color:"primary"},"Exit"))))}var de=a(96),pe=a.n(de),he=a(222);function fe(e){var t=d().auth,a=Object(n.useState)(!1),c=Object(o.a)(a,2),l=c[0],i=c[1],u=Object(n.useState)([]),s=Object(o.a)(u,2),m=s[0],E=s[1],p=function(){i(!1)},h=function(){fetch(e.ticket._links.ticketStatus.href,{headers:{Authorization:"Bearer ".concat(t.token)}}).then((function(e){return e.json()})).then((function(e){return E(e)}))};return r.a.createElement("div",null,r.a.createElement(se.a,{title:"Status"},r.a.createElement(b.a,{onClick:function(){return i(!0),void h()}},r.a.createElement(pe.a,null))),r.a.createElement(re.a,{open:l,onClose:p,"aria-labelledby":"form-dialog-title"},r.a.createElement(oe.a,{id:"form-dialog-title"},"Ticket Status"),r.a.createElement(le.a,null,r.a.createElement(he.a,null," ",m.name)),r.a.createElement(ce.a,null,r.a.createElement(y.a,{onClick:p,color:"primary"},"Exit"))))}var ge=a(223),be=(r.a.createContext(),Object(v.a)((function(e){return{root:{flexGrow:1,textAlign:"center"}}}))),ke={tickets:[],isFetching:!1,hasError:!1,isTicketSubmitting:!1,songHasError:!1},ve=function(e,t){switch(t.type){case"FETCH_TICKETS_REQUEST":return Object(i.a)({},e,{isFetching:!0,hasError:!1});case"FETCH_TICKETS_SUCCESS":return Object(i.a)({},e,{isFetching:!1,tickets:t.payload});case"FETCH_TICKETS_FAILURE":return Object(i.a)({},e,{hasError:!0,isFetching:!1});case"PATCH_TICKET_REQUEST":return Object(i.a)({},e,{isTicketSubmitting:!0,songHasError:!1});case"PATCH_TICKET_SUCCESS":return Object(i.a)({},e,{isTicketSubmitting:!1,tickets:[].concat(Object(ee.a)(e.tickets),[t.payload])});case"PATCH_TICKET_FAILURE":return Object(i.a)({},e,{isTicketSubmitting:!1,songHasError:!0});default:return e}},Ce=function(){var e=d().auth,t=r.a.useReducer(ve,ke),a=Object(o.a)(t,2),c=a[0],l=a[1],i=be();Object(n.useEffect)((function(){l({type:"FETCH_TICKETS_REQUEST"}),fetch("https://rbmk-ticketguru-backend.herokuapp.com/api/tickets",{headers:{Authorization:"Bearer ".concat(e.token)}}).then((function(e){if(e.ok)return e.json();throw e})).then((function(e){console.log(e._embedded.tickets),l({type:"FETCH_TICKETS_SUCCESS",payload:e._embedded.tickets})})).catch((function(e){console.log(e),l({type:"FETCH_TICKETS_FAILURE"})}))}),[e.token]);var u=[{Header:"",sortable:!1,filterable:!1,width:60,accessor:"_links.self.href",Cell:function(e){return r.a.createElement(Ee,{ticket:e.original})}},{Header:"Checksum",accessor:"checkSum",style:{display:"flex",flexDirection:"column",justifyContent:"center"}},{id:"invalid",Header:"Invalidated",style:{display:"flex",flexDirection:"column",justifyContent:"center"},accessor:function(e){return null===e.invalid?"":ne()(e.invalid).format("DD/MM/YYYY  HH:mm")}},{Header:"",sortable:!1,filterable:!1,width:60,accessor:"_links.ticketStatus.href",Cell:function(e){return r.a.createElement(fe,{ticket:e.original})}}];return r.a.createElement("div",{className:i.root},c.isFetching?r.a.createElement("span",{className:"loader"},"LOADING..."):c.hasError?r.a.createElement("span",{className:"error"},"AN ERROR HAS OCCURED"):r.a.createElement(te.a,{filterable:!1,data:c.tickets,columns:u,SubComponent:function(e){return r.a.createElement("div",null,r.a.createElement(ge.a,{align:"center",type:"number",id:"quantity",name:"quantity",defaultValue:"1"}),r.a.createElement(y.a,{size:"small",variant:"contained",color:"primary"},"Testi"))}}))},Se=a(97),ye=a.n(Se);function Te(){var e=d().auth,t=Object(n.useState)({result:"No result"}),a=Object(o.a)(t,2),c=a[0],l=a[1],i=function(){fetch("https://rbmk-ticketguru-backend.herokuapp.com/api/tickets/validate/".concat(c.result),{headers:{Authorization:"Bearer ".concat(e.token)}}).then((function(e){return e.json()})).then((function(e){return console.log(e)}))};return r.a.createElement("div",null,r.a.createElement(ye.a,{delay:300,onError:function(e){console.error(e)},onScan:function(e){e&&(l({result:e}),i())},style:{width:500}}),r.a.createElement("h4",null,c.result))}var Oe=Object(v.a)((function(e){return{root:{flexGrow:1,padding:e.spacing(3),textAlign:"center",alignContent:"strech"}}}));function je(){var e=Oe();return r.a.createElement("div",{className:e.root},r.a.createElement(k.a,{variant:"h1",component:"h2",gutterBottom:!0},"Lue lippusi"),r.a.createElement(Te,null),r.a.createElement(j.a,null))}var Ne=a(102),we=function(e){var t=e.component,a=Object(Ne.a)(e,["component"]),n=d().auth;return r.a.createElement(B.b,Object.assign({},a,{render:function(e){var a=e.props;return n.isAuthenticated?r.a.createElement(t,a):r.a.createElement(B.a,{to:{pathname:"/auth"}})}}))},xe=function(){return r.a.createElement("div",null,r.a.createElement(we,{path:"/app/home",component:D}),r.a.createElement(we,{path:"/app/events",component:Z}),r.a.createElement(we,{path:"/app/tickets",component:Ce}),r.a.createElement(we,{path:"/app/ticketreader",component:je}),r.a.createElement(B.a,{from:"/app",to:"/app/home",exact:!0}))},_e=a(229),Fe=a(225),Ae=a(226),He=a(227),Ie=a(99),Re=a.n(Ie),Ue=a(224);function Le(){return r.a.createElement(k.a,{variant:"body2",color:"textSecondary",align:"center"},"Copyright \xa9 ",r.a.createElement(p.b,{color:"inherit",to:"#"},"TicketGuru")," ",(new Date).getFullYear(),".")}var Be=Object(v.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),Ge=function(){var e=Object(n.useContext)(u).dispatch,t=Object(B.g)(),a=Be(),c=Object(n.useState)({username:"",password:"",isSubmitting:!1,errorMessage:null}),l=Object(o.a)(c,2),s=l[0],m=l[1],E=function(e){m(Object(i.a)({},s,Object(h.a)({},e.target.name,e.target.value)))};return r.a.createElement(Ue.a,{component:"main",maxWidth:"xs"},r.a.createElement(Fe.a,null),r.a.createElement("div",{className:a.paper},r.a.createElement(_e.a,{className:a.avatar},r.a.createElement(Re.a,null)),r.a.createElement(k.a,{component:"h1",variant:"h5"},"Sign in"),r.a.createElement("form",{className:a.form},r.a.createElement(Ae.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"User Name",name:"username",autoComplete:"username",autoFocus:!0,onChange:E,value:s.username}),r.a.createElement(Ae.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:E,value:s.password}),s.errorMessage&&r.a.createElement("span",{className:"form-error"},s.errorMessage),r.a.createElement(y.a,{disabled:s.isSubmitting,fullWidth:!0,href:"/home",variant:"contained",color:"primary",className:a.submit,onClick:function(a){a.preventDefault(),m(Object(i.a)({},s,{isSubmitting:!0,errorMessage:null}));var n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",authorization:"jwt"},body:JSON.stringify({username:s.username,password:s.password})};fetch("https://rbmk-ticketguru-backend.herokuapp.com/api/login",n).then((function(e){if(e.ok)return e.json();throw e})).then((function(t){e({type:"LOGIN_SUCCESS",payload:t})})).catch((function(e){m(Object(i.a)({},s,{isSubmitting:!1,errorMessage:e.message||e.statusText}))})),t.push("/app/home")}},s.isSubmitting?"Loading...":"Login"),r.a.createElement(K.a,{container:!0},r.a.createElement(K.a,{item:!0,xs:!0},r.a.createElement(k.a,{variant:"body2",align:"center"},r.a.createElement(p.b,{to:"#",variant:"body2"},"Forgot password?")))))),r.a.createElement(He.a,{mt:8},r.a.createElement(Le,null)))},De=function(){return r.a.createElement("div",null,r.a.createElement(B.b,{exact:!0,path:"/auth/login",component:Ge}),r.a.createElement(B.a,{from:"/auth",to:"/auth/login",exact:!0}))},Me=(a(150),function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"gandalf"},r.a.createElement("div",{className:"fireball"}),r.a.createElement("div",{className:"skirt"}),r.a.createElement("div",{className:"sleeves"}),r.a.createElement("div",{className:"shoulders"},r.a.createElement("div",{className:"hand left"}),r.a.createElement("div",{className:"hand right"})),r.a.createElement("div",{className:"head"},r.a.createElement("div",{className:"hair"}),r.a.createElement("div",{className:"beard"}))),r.a.createElement("div",{className:"message"},r.a.createElement("h1",null,"403 - You Shall Not Pass"),r.a.createElement("p",null,"Uh oh, Gandalf is blocking the way!",r.a.createElement("br",null),"Maybe you have a typo in the url? Or you meant to go to a different location? Like...Hobbiton?")),r.a.createElement("p",null,r.a.createElement(p.b,{to:"/auth"},"Back to Home")))}),qe=function(){return r.a.createElement("div",null,r.a.createElement(B.d,null,r.a.createElement(B.b,{path:"/app",component:xe}),r.a.createElement(B.b,{path:"/auth",component:De}),r.a.createElement(B.b,{component:Me})))};var Ke=function(){return r.a.createElement(p.a,null,r.a.createElement(E,null,r.a.createElement(L,null),r.a.createElement(qe,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(151);l.a.render(r.a.createElement(Ke,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[123,1,2]]]);
//# sourceMappingURL=main.ac26ab66.chunk.js.map